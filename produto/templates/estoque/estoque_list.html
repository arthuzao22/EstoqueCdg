{% load static %}
<!DOCTYPE html>
<html lang="pt-br">
  {% include 'components/header/header.html' %}

  <body>
    <style>
      /* Estilos rápidos para a página de estoque (podem mover para arquivo CSS) */
      .filtro-categorias { display:flex; gap:8px; overflow:auto; padding:8px 0; }
      .filtro-categorias button { border-radius:20px; padding:6px 12px; }
      .grid-estoque { display:grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap:16px; }
      .card-estoque { background: #fff; border-radius:12px; box-shadow: 0 6px 18px rgba(0,0,0,0.06); padding:16px; }
      .card-estoque h5 { margin:0 0 8px 0; font-size:16px; }
      .card-estoque .meta { color:#666; font-size:14px; }
      .badge-qtde { background:#007bff; color:#fff; padding:6px 10px; border-radius:999px; font-weight:600; }
      .empty-msg { text-align:center; padding:40px 0; color:#666; }
    </style>

    <!-- Filtros -->
    <div class="mb-3 d-flex justify-content-center">
      <form method="get" action="{% url 'estoque-list' %}" class="filtro-categorias">
        <button type="submit" name="categorias_filter" value="" class="btn btn-outline-secondary">Todas</button>
        {% for categoria in categorias %}
          <button type="submit" name="categorias_filter" value="{{ categoria.id }}" id="btn_color{{ categoria.id }}" class="btn btn-outline-secondary">{{ categoria.categoria }}</button>
        {% endfor %}
      </form>
    </div>

    <!-- Grid de Estoque -->
    <div class="grid-estoque">
      {% for estoque in estoques %}
        <div class="card-estoque">
          <h5>{{ estoque.id_produto.nome }} {% if estoque.id_produto.formato %}- {{ estoque.id_produto.formato }}{% endif %}</h5>
          <div class="meta">Categoria: {{ estoque.id_produto.id_categoria.categoria }}</div>
          <div class="d-flex justify-content-between align-items-center mt-3">
            <div>
              <div class="meta">Unidades por item</div>
              <div class="fw-bold">{{ estoque.id_produto.unidades|default:1 }}</div>
            </div>
            <div class="text-end">
              <div class="meta">Quantidade</div>
              <div class="badge-qtde">{{ estoque.qtde }}</div>
            </div>
          </div>
          <hr>
          <div class="d-flex justify-content-between">
            <small class="meta">Total unidades</small>
            <strong class="numero">{{ estoque.calculo }}</strong>
          </div>
        </div>
      {% empty %}
        <div class="empty-msg">Nenhum item no estoque.</div>
      {% endfor %}
    </div>

    <script>
      function formatarNumero(numero) { return numero.toLocaleString('pt-BR'); }
      document.querySelectorAll('.numero').forEach(function (el) { el.innerText = formatarNumero(parseInt(el.innerText) || 0); });
    </script>
  {% include 'components/footer/footer.html' %}
</html>
